@page "/switch"
@rendermode InteractiveWebAssembly

<PageTitle>Switch</PageTitle>

<h1>Switch</h1>

<div class="mb-5">
    <h2>Basic Switch</h2>
    <div class="d-flex align-items-center">
        <SwitchRoot @bind-Checked="_checked" class="switch-root" data-testid="basic-switch">
            <SwitchThumb class="switch-thumb" />
        </SwitchRoot>
        <span class="ms-2">@(_checked ? "Checked" : "Unchecked")</span>
    </div>
</div>

<div class="mb-5">
    <h2>Disabled Switch</h2>
    <div class="d-flex align-items-center gap-4">
        <div class="d-flex align-items-center">
            <SwitchRoot Checked="true" Disabled="true" class="switch-root" data-testid="disabled-checked-switch">
                <SwitchThumb class="switch-thumb" />
            </SwitchRoot>
            <span class="ms-2">Disabled Checked</span>
        </div>
        <div class="d-flex align-items-center">
            <SwitchRoot Checked="false" Disabled="true" class="switch-root" data-testid="disabled-unchecked-switch">
                <SwitchThumb class="switch-thumb" />
            </SwitchRoot>
            <span class="ms-2">Disabled Unchecked</span>
        </div>
    </div>
</div>

<div class="mb-5">
    <h2>Form Submission</h2>
    <form @onsubmit="HandleSubmit" class="d-flex flex-column gap-3" style="max-width: 300px;">
        <div class="d-flex align-items-center justify-content-between">
            <label for="notifications">Notifications</label>
            <SwitchRoot Name="notifications" @bind-Checked="_notifications" id="notifications" class="switch-root" data-testid="notifications-switch">
                <SwitchThumb class="switch-thumb" />
            </SwitchRoot>
        </div>
        
        <div class="d-flex align-items-center justify-content-between">
             <label for="marketing">Marketing Emails</label>
             <SwitchRoot Name="marketing" Value="yes" @bind-Checked="_marketing" id="marketing" class="switch-root" data-testid="marketing-switch">
                 <SwitchThumb class="switch-thumb" />
             </SwitchRoot>
        </div>

        <button type="submit" class="btn btn-primary">Submit</button>
    </form>
    
    @if (_lastSubmitData != null)
    {
        <div class="mt-3 alert alert-info">
            <pre>@_lastSubmitData</pre>
        </div>
    }
</div>

<div class="mb-5">
    <h2>Controlled Mode</h2>
    <div class="d-flex flex-column gap-3">
        <div class="d-flex align-items-center gap-3">
            <SwitchRoot @bind-Checked="_controlledChecked" class="switch-root" data-testid="controlled-switch">
                <SwitchThumb class="switch-thumb" />
            </SwitchRoot>
            <button type="button" class="btn btn-secondary" @onclick="ToggleControlled">
                Toggle Externally (@(_controlledChecked ? "Checked" : "Unchecked"))
            </button>
        </div>
    </div>
</div>

<div class="mb-5">
    <h2>With Label</h2>
    <label class="d-flex align-items-center gap-2" data-testid="labeled-switch-container">
        <SwitchRoot @bind-Checked="_labeledChecked" class="switch-root" data-testid="labeled-switch">
            <SwitchThumb class="switch-thumb" />
        </SwitchRoot>
        <span>Enable notifications</span>
    </label>
</div>

<div class="mb-5">
    <h2>Default Checked</h2>
    <div class="d-flex align-items-center">
        <SwitchRoot DefaultChecked="true" class="switch-root" data-testid="default-checked-switch">
            <SwitchThumb class="switch-thumb" />
        </SwitchRoot>
        <span class="ms-2">Default checked (uncontrolled)</span>
    </div>
</div>

<div class="mb-5">
    <h2>Required Switch</h2>
    <form class="d-flex flex-column gap-3" style="max-width: 300px;">
        <div class="d-flex align-items-center justify-content-between">
            <label for="required-switch">Accept Terms</label>
            <SwitchRoot Name="terms" Required="true" @bind-Checked="_required" id="required-switch" class="switch-root" data-testid="required-switch">
                <SwitchThumb class="switch-thumb" />
            </SwitchRoot>
        </div>
    </form>
</div>

<style>
    .switch-root {
        all: unset;
        display: inline-flex;
        width: 42px;
        height: 25px;
        background-color: #e4e4e7;
        border-radius: 9999px;
        position: relative;
        box-shadow: 0 2px 10px var(--black-a7);
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
        cursor: pointer;
    }

    .switch-root:focus-visible {
        box-shadow: 0 0 0 2px black;
    }

    .switch-root[data-state='checked'] {
        background-color: #000;
    }
    
    .switch-root[data-disabled] {
        opacity: 0.5;
        cursor: not-allowed;
    }

    .switch-thumb {
        display: block;
        width: 21px;
        height: 21px;
        background-color: white;
        border-radius: 9999px;
        box-shadow: 0 2px 2px var(--black-a7);
        transition: transform 100ms;
        transform: translateX(2px);
        will-change: transform;
        margin-top: 2px;
    }

    .switch-root[data-state='checked'] .switch-thumb {
        transform: translateX(19px);
    }
</style>

@code {
    private bool _checked;
    private bool _notifications;
    private bool _marketing;
    private bool _controlledChecked;
    private bool _labeledChecked;
    private bool _required;
    private string? _lastSubmitData;

    private void HandleSubmit()
    {
        _lastSubmitData = $"Notifications: {_notifications}, Marketing: {_marketing}";
    }

    private void ToggleControlled()
    {
        _controlledChecked = !_controlledChecked;
    }
}
