@namespace SummitUI

@* A cell in the calendar grid representing a single date. *@

<td role="gridcell"
    data-summit-calendar-cell
    data-state="@(_isSelected ? "selected" : null)"
    data-today="@(_isToday ? true : null)"
    data-outside-month="@(_isOutsideMonth ? true : null)"
    data-unavailable="@(_isUnavailable ? true : null)"
    data-disabled="@(_isDisabled ? true : null)"
    @attributes="AdditionalAttributes">

    <CascadingValue Value="_cellContext" IsFixed="false">
        @if (ChildContent is not null)
        {
            @ChildContent(_cellContext)
        }
        else if (SimpleContent is not null)
        {
            @SimpleContent
        }
    </CascadingValue>
</td>

@code {
    private bool _isSelected;
    private bool _isToday;
    private bool _isFocused;
    private bool _isOutsideMonth;
    private bool _isUnavailable;
    private bool _isDisabled;
    private CalendarCellContext _cellContext = default!;

    protected override void OnParametersSet()
    {
        _isSelected = Context.IsSelected(Date);
        _isToday = Context.IsToday(Date);
        _isFocused = Context.IsFocused(Date);
        _isOutsideMonth = Context.IsOutsideMonth(Date);
        _isUnavailable = Context.IsDateUnavailable(Date);
        _isDisabled = Context.Disabled;

        _cellContext = new CalendarCellContext
        {
            Date = Date,
            IsSelected = _isSelected,
            IsToday = _isToday,
            IsFocused = _isFocused,
            IsOutsideMonth = _isOutsideMonth,
            IsUnavailable = _isUnavailable,
            IsDisabled = _isDisabled
        };
    }
}
