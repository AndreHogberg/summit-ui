@page "/tests/checkbox/editform"
@rendermode InteractiveWebAssembly
@using System.ComponentModel.DataAnnotations
@using Microsoft.AspNetCore.Components.Forms

@if (!RendererInfo.IsInteractive)
{
    <div data-testid="page-loading">Loading...</div>
}
else
{
<div data-testid="page-ready">
    <h1>Checkbox EditForm Tests</h1>

    <section data-testid="editform-section">
        <EditForm Model="@editFormModel" OnValidSubmit="HandleEditFormSubmit">
            <DataAnnotationsValidator />

            <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                <label class="checkbox-label">
                    <CheckboxRoot Checked="@editFormModel.AcceptTerms"
                                  CheckedChanged="@(v => { editFormModel.AcceptTerms = v; })"
                                  Name="acceptTerms"
                                  Required="true"
                                  data-testid="editform-terms-checkbox"
                                  class="checkbox-root">
                        <CheckboxIndicator>
                            <span>✓</span>
                        </CheckboxIndicator>
                    </CheckboxRoot>
                    Accept Terms and Conditions (Required)
                </label>
                <ValidationMessage For="@(() => editFormModel.AcceptTerms)" class="validation-error" />

                <label class="checkbox-label">
                    <CheckboxRoot Checked="@editFormModel.SubscribeNewsletter"
                                  CheckedChanged="@(v => { editFormModel.SubscribeNewsletter = v; })"
                                  Name="subscribeNewsletter"
                                  data-testid="editform-newsletter-checkbox"
                                  class="checkbox-root">
                        <CheckboxIndicator>
                            <span>✓</span>
                        </CheckboxIndicator>
                    </CheckboxRoot>
                    Subscribe to Newsletter (Optional)
                </label>

                <label class="checkbox-label">
                    <CheckboxRoot Checked="@editFormModel.EnableNotifications"
                                  CheckedChanged="@(v => { editFormModel.EnableNotifications = v; })"
                                  Name="enableNotifications"
                                  data-testid="editform-notifications-checkbox"
                                  class="checkbox-root">
                        <CheckboxIndicator>
                            <span>✓</span>
                        </CheckboxIndicator>
                    </CheckboxRoot>
                    Enable Notifications (Optional)
                </label>
            </div>

            <div style="margin-top: 1rem;">
                <button type="submit" class="btn" data-testid="editform-submit">Submit</button>
            </div>

            <div style="margin-top: 0.5rem; font-size: 0.875rem; color: #666;">
                <p>Accept Terms: <span data-testid="editform-terms-value">@editFormModel.AcceptTerms</span></p>
                <p>Subscribe Newsletter: <span data-testid="editform-newsletter-value">@editFormModel.SubscribeNewsletter</span></p>
                <p>Enable Notifications: <span data-testid="editform-notifications-value">@editFormModel.EnableNotifications</span></p>
            </div>

            @if (editFormSubmitted)
            {
                <p style="margin-top: 0.5rem; color: green;" data-testid="editform-success-message">Form submitted successfully!</p>
            }
        </EditForm>
    </section>
</div>
}

@code {
    private CheckboxFormModel editFormModel = new();
    private bool editFormSubmitted = false;

    private class CheckboxFormModel
    {
        [Range(typeof(bool), "true", "true", ErrorMessage = "You must accept the terms and conditions")]
        public bool AcceptTerms { get; set; }

        public bool SubscribeNewsletter { get; set; }

        public bool EnableNotifications { get; set; }
    }

    private void HandleEditFormSubmit()
    {
        editFormSubmitted = true;
    }
}

<style>
    section {
        padding: 1rem;
        border: 1px solid #eee;
        border-radius: 8px;
        background: #fafafa;
    }

    .checkbox-label {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        cursor: pointer;
    }

    .checkbox-root {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 20px;
        height: 20px;
        border: 2px solid #666;
        border-radius: 4px;
        background: white;
        cursor: pointer;
        font-size: 14px;
        padding: 0;
    }

    .checkbox-root[data-state="checked"] {
        background: #4f46e5;
        border-color: #4f46e5;
        color: white;
    }

    .btn {
        padding: 0.5rem 1rem;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        background: #4f46e5;
        color: white;
    }

    .validation-error {
        color: #dc2626;
        font-size: 0.875rem;
    }
</style>
