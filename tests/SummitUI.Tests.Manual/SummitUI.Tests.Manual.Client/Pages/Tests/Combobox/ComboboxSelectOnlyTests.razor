@page "/tests/combobox/select-only"
@rendermode InteractiveWebAssembly

@* 
    Test page for select-only Combobox (no input, trigger-based).
    Tests keyboard navigation when there's no input element.
*@

@if (!RendererInfo.IsInteractive)
{
    <div data-testid="page-loading">Loading...</div>
}
else
{
<div data-testid="page-ready">
    <ComboboxRoot TValue="string" @bind-Values="selectedValues">
        <ComboboxTrigger TValue="string" data-testid="trigger">
            <ComboboxSelectedValues TValue="string" Context="items">
                @if (items.Count == 0)
                {
                    <span data-placeholder>Select fruits...</span>
                }
                else
                {
                    <span>@items.Count selected</span>
                }
            </ComboboxSelectedValues>
            <span class="chevron">▼</span>
        </ComboboxTrigger>
        <ComboboxPortal TValue="string">
            <ComboboxContent TValue="string" data-testid="content" SideOffset="4">
                <ComboboxViewport TValue="string">
                    <ComboboxItem TValue="string" Value="@("apple")" Label="Apple" data-testid="item-apple">
                        <span class="checkbox">@(selectedValues.Contains("apple") ? "☑" : "☐")</span>
                        Apple
                    </ComboboxItem>
                    <ComboboxItem TValue="string" Value="@("banana")" Label="Banana" data-testid="item-banana">
                        <span class="checkbox">@(selectedValues.Contains("banana") ? "☑" : "☐")</span>
                        Banana
                    </ComboboxItem>
                    <ComboboxItem TValue="string" Value="@("orange")" Label="Orange" data-testid="item-orange">
                        <span class="checkbox">@(selectedValues.Contains("orange") ? "☑" : "☐")</span>
                        Orange
                    </ComboboxItem>
                    <ComboboxItem TValue="string" Value="@("grape")" Label="Grape" data-testid="item-grape">
                        <span class="checkbox">@(selectedValues.Contains("grape") ? "☑" : "☐")</span>
                        Grape
                    </ComboboxItem>
                    <ComboboxItem TValue="string" Value="@("mango")" Label="Mango" data-testid="item-mango">
                        <span class="checkbox">@(selectedValues.Contains("mango") ? "☑" : "☐")</span>
                        Mango
                    </ComboboxItem>
                </ComboboxViewport>
            </ComboboxContent>
        </ComboboxPortal>
    </ComboboxRoot>
    
    <div data-testid="selection-count">@selectedValues.Count selected</div>
</div>
}

@code {
    private IReadOnlyCollection<string> selectedValues = Array.Empty<string>();
}

<style>
    [data-testid="trigger"] {
        display: inline-flex;
        align-items: center;
        justify-content: space-between;
        min-width: 200px;
        padding: 0.5rem 0.75rem;
        background: white;
        border: 1px solid #ccc;
        border-radius: 6px;
        cursor: pointer;
    }
    
    [data-testid="trigger"]:focus {
        outline: 2px solid #0d6efd;
        outline-offset: 2px;
    }
    
    [data-testid="content"] {
        background: white;
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        min-width: 200px;
        padding: 0.25rem;
    }
    
    [data-summit-combobox-item] {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.5rem 0.75rem;
        border-radius: 4px;
        cursor: pointer;
    }
    
    [data-summit-combobox-item][data-highlighted] {
        background: #f0f0f0;
    }
    
    [data-summit-combobox-item][data-selected] {
        background: #e7f1ff;
    }
    
    [data-summit-combobox-item][data-highlighted][data-selected] {
        background: #cce5ff;
    }
    
    .checkbox {
        font-family: sans-serif;
    }
    
    .chevron {
        font-size: 0.75rem;
        opacity: 0.6;
    }
    
    [data-placeholder] {
        color: #999;
    }
</style>
