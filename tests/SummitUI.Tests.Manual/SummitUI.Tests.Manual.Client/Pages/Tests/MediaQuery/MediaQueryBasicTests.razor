@page "/tests/mediaquery/basic"
@rendermode InteractiveWebAssembly

@if (!RendererInfo.IsInteractive)
{
    <div data-testid="page-loading">Loading...</div>
}
else
{
<div data-testid="page-ready">
    <h1>MediaQuery Basic Tests</h1>

    <div style="display: flex; flex-direction: column; gap: 1rem;">
        <!-- Basic viewport width query -->
        <div data-testid="viewport-test">
            <MediaQuery Query="(min-width: 500px)" Context="IsWide">
                <div data-testid="viewport-result" data-matches="@IsWide.ToString().ToLowerInvariant()">
                    Viewport matches: @IsWide
                </div>
            </MediaQuery>
        </div>

        <!-- Very small query that should always match on desktop -->
        <div data-testid="always-match-test">
            <MediaQuery Query="(min-width: 1px)" Context="Matches">
                <div data-testid="always-match-result" data-matches="@Matches.ToString().ToLowerInvariant()">
                    Always matches: @Matches
                </div>
            </MediaQuery>
        </div>

        <!-- Very large query that should never match -->
        <div data-testid="never-match-test">
            <MediaQuery Query="(min-width: 99999px)" Context="Matches">
                <div data-testid="never-match-result" data-matches="@Matches.ToString().ToLowerInvariant()">
                    Never matches: @Matches
                </div>
            </MediaQuery>
        </div>

        <!-- InitialValue test -->
        <div data-testid="initial-value-test">
            <MediaQuery Query="(min-width: 99999px)" InitialValue="true" Context="Matches">
                <div data-testid="initial-value-result" data-matches="@Matches.ToString().ToLowerInvariant()">
                    With InitialValue=true (should be false after JS): @Matches
                </div>
            </MediaQuery>
        </div>

        <!-- OnChange callback test -->
        <div data-testid="onchange-test">
            <div data-testid="change-count">Change count: @changeCount</div>
            <MediaQuery Query="(min-width: 600px)" Context="Matches" OnChange="HandleChange">
                <div data-testid="onchange-result" data-matches="@Matches.ToString().ToLowerInvariant()">
                    Matches 600px: @Matches
                </div>
            </MediaQuery>
        </div>

        <!-- Orientation query -->
        <div data-testid="orientation-test">
            <MediaQuery Query="(orientation: landscape)" Context="IsLandscape">
                <div data-testid="orientation-result" data-matches="@IsLandscape.ToString().ToLowerInvariant()">
                    Is landscape: @IsLandscape
                </div>
            </MediaQuery>
        </div>

        <!-- Hover capability query -->
        <div data-testid="hover-test">
            <MediaQuery Query="(hover: hover)" Context="HasHover">
                <div data-testid="hover-result" data-matches="@HasHover.ToString().ToLowerInvariant()">
                    Has hover: @HasHover
                </div>
            </MediaQuery>
        </div>

        <!-- Multiple MediaQuery components -->
        <div data-testid="multiple-test">
            <MediaQuery Query="(min-width: 400px)" Context="Is400">
                <MediaQuery Query="(min-width: 800px)" Context="Is800">
                    <div data-testid="multiple-result" 
                         data-is400="@Is400.ToString().ToLowerInvariant()" 
                         data-is800="@Is800.ToString().ToLowerInvariant()">
                        400px: @Is400, 800px: @Is800
                    </div>
                </MediaQuery>
            </MediaQuery>
        </div>

        <!-- Conditional rendering test -->
        <div data-testid="conditional-test">
            <MediaQuery Query="(min-width: 1px)" Context="ShouldShow">
                @if (ShouldShow)
                {
                    <div data-testid="conditional-shown">This content is shown</div>
                }
                else
                {
                    <div data-testid="conditional-hidden">This content is hidden</div>
                }
            </MediaQuery>
        </div>
    </div>
</div>
}

@code {
    private int changeCount = 0;

    private void HandleChange(bool matches)
    {
        changeCount++;
    }
}

<style>
    div[data-testid] {
        padding: 0.5rem;
        margin: 0.25rem 0;
    }

    div[data-matches="true"] {
        background-color: #d4edda;
        border: 1px solid #c3e6cb;
    }

    div[data-matches="false"] {
        background-color: #f8d7da;
        border: 1px solid #f5c6cb;
    }
</style>
